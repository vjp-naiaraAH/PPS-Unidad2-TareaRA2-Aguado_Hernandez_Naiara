{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"PPS - Unidad 2 - Tarea RA2 Niveles de seguridad requeridos por las aplicaciones Esta es la documentaci\u00f3n completa de la tarea obligatoria RA2. Esta tarea cubre el trazado de vulnerabilidades, an\u00e1lisis en entornos vulnerables, comprobaci\u00f3n de requisitos ASVS y una reflexi\u00f3n sobre riesgos reales de aplicaciones. \u00cdndice de apartados Apartado 1 - Trazado de vulnerabilidad Trazado y an\u00e1lisis de CVE en GoAnywhere MFT (incluye registro JSON). Apartado 2 - An\u00e1lisis de vulnerabilidad en m\u00e1quina vulnerable Explotaci\u00f3n pr\u00e1ctica y medidas de securizaci\u00f3n. Apartado 3 - Comprobaci\u00f3n de los requisitos de seguridad de una aplicaci\u00f3n Evaluaci\u00f3n detallada con OWASP ASVS (niveles 1 y 2) + hoja de c\u00e1lculo. Apartado 4 - Reflexi\u00f3n sobre los riesgos de las aplicaciones An\u00e1lisis personal comparando con aplicaciones bancarias, de salud y redes sociales. Evidencias descargables Registro CVE en JSON Hoja de c\u00e1lculo ASVS Carpeta de capturas de pantalla \u00a1Espero que la documentaci\u00f3n sea clara y \u00fatil!","title":"PPS - Unidad 2 - Tarea RA2"},{"location":"#pps-unidad-2-tarea-ra2","text":"Niveles de seguridad requeridos por las aplicaciones Esta es la documentaci\u00f3n completa de la tarea obligatoria RA2. Esta tarea cubre el trazado de vulnerabilidades, an\u00e1lisis en entornos vulnerables, comprobaci\u00f3n de requisitos ASVS y una reflexi\u00f3n sobre riesgos reales de aplicaciones.","title":"PPS - Unidad 2 - Tarea RA2"},{"location":"#indice-de-apartados","text":"Apartado 1 - Trazado de vulnerabilidad Trazado y an\u00e1lisis de CVE en GoAnywhere MFT (incluye registro JSON). Apartado 2 - An\u00e1lisis de vulnerabilidad en m\u00e1quina vulnerable Explotaci\u00f3n pr\u00e1ctica y medidas de securizaci\u00f3n. Apartado 3 - Comprobaci\u00f3n de los requisitos de seguridad de una aplicaci\u00f3n Evaluaci\u00f3n detallada con OWASP ASVS (niveles 1 y 2) + hoja de c\u00e1lculo. Apartado 4 - Reflexi\u00f3n sobre los riesgos de las aplicaciones An\u00e1lisis personal comparando con aplicaciones bancarias, de salud y redes sociales.","title":"\u00cdndice de apartados"},{"location":"#evidencias-descargables","text":"Registro CVE en JSON Hoja de c\u00e1lculo ASVS Carpeta de capturas de pantalla \u00a1Espero que la documentaci\u00f3n sea clara y \u00fatil!","title":"Evidencias descargables"},{"location":"ComprobacionRequisitosAplicacion_naiara/","text":"Comprobaci\u00f3n de Requisitos de Seguridad 1. Nivel de seguridad requerido por la aplicaci\u00f3n La aplicaci\u00f3n consiste en dos scripts Python sencillos ( lavadero.py y main_app.py ) que simulan el funcionamiento de un t\u00fanel de lavado de coches mediante una m\u00e1quina de estados en consola. Caracter\u00edsticas clave que determinan el nivel de seguridad ASVS: Es una aplicaci\u00f3n de consola local , ejecutada directamente en el equipo del desarrollador/estudiante (no hay servidor, no hay interfaz web, no hay API). No existe autenticaci\u00f3n de usuarios, gesti\u00f3n de sesiones ni roles. No recibe entrada de fuentes externas no confiables: los par\u00e1metros (prelavado, secado, encerado) se pasan directamente en el c\u00f3digo o como argumentos fijos en ejemplos de prueba. No hay lectura de stdin interactiva peligrosa, ni par\u00e1metros HTTP, ni ficheros subidos, ni conexiones a red. No maneja ni almacena datos sensibles (PII, financieros, m\u00e9dicos, contrase\u00f1as, claves, etc.). Solo acumula un valor num\u00e9rico de ingresos simulados en memoria. No utiliza dependencias externas (solo librer\u00edas est\u00e1ndar de Python: ninguna instalaci\u00f3n v\u00eda pip). No hay operaciones criptogr\u00e1ficas, logging persistente, uploads/downloads, deserializaci\u00f3n de datos no confiables, llamadas a comandos del sistema ni acceso a recursos del sistema de forma peligrosa. Las \u00fanicas \"entradas\" son booleanos controlados por el programador; no hay riesgo real de inyecci\u00f3n, overflow, path traversal, etc. Por todo ello, el nivel de seguridad m\u00e1s adecuado seg\u00fan OWASP ASVS es el Nivel 1 (L1 \u2013 Opportunistic / Protecci\u00f3n contra vulnerabilidades f\u00e1ciles de descubrir y ataques automatizados b\u00e1sicos). Nivel 2 ya requerir\u00eda controles que no aplican aqu\u00ed (TLS obligatorio, logging de seguridad detallado, protecci\u00f3n contra CSRF, gesti\u00f3n segura de secretos, etc.). Nivel 3 es para aplicaciones cr\u00edticas con requisitos de alta assurance (HSM, re-autenticaci\u00f3n frecuente, auditor\u00eda estricta, etc.). En resumen: ASVS Nivel 1 es suficiente y realista para esta aplicaci\u00f3n sin exposici\u00f3n ni valor real en juego. 2. Hoja de c\u00e1lculo cumplimentada He descargado la plantilla OWASP ASVS checklist for audits (versi\u00f3n 4.0.2) y la he renombrado como ASVS-Checklist-Naiara.xlsx . Archivo subido en la tarea: ASVS-Checklist-Naiara.ods He rellenado principalmente las secciones solicitadas en la actividad: Input Validation (hoja 5): varios requisitos marcados como \"Valid\" o \"Non-valid\" con comentarios y referencias al c\u00f3digo. Malicious Code (hoja 10): la mayor\u00eda marcados como \"Not Applicable\" por ser una aplicaci\u00f3n de Nivel 1 y sin carga din\u00e1mica de c\u00f3digo, sin permisos excesivos, sin phone-home, etc. En la pesta\u00f1a ASVS_Results se observa: Cumplimiento total: ~1.09% (3 de 276 criterios cumplidos). \u00danica categor\u00eda con algo de cumplimiento: Input Validation (~11.11%). Todas las dem\u00e1s categor\u00edas a 0% . Esto es completamente esperable dada la simplicidad extrema de la aplicaci\u00f3n. Capturas de pantalla: - Resultados globales y gr\u00e1fico de telara\u00f1a: Secci\u00f3n Input Validation (detalle): Secci\u00f3n Malicious Code (detalle): 3. An\u00e1lisis del grado de cobertura El porcentaje global de cumplimiento es extremadamente bajo ( 1.09% ), con solo 3 criterios validados de 276 totales. La \u00fanica categor\u00eda que muestra algo de cumplimiento es Input Validation (11.11%), mientras que el resto de secciones (Arquitectura, Autenticaci\u00f3n, Sesiones, Acceso, Criptograf\u00eda, Logging, etc.) est\u00e1n al 0%. Reflexi\u00f3n: Esta cobertura tan baja no indica que la aplicaci\u00f3n sea insegura , sino que es demasiado simple para que la gran mayor\u00eda de los controles ASVS sean aplicables. ASVS est\u00e1 dise\u00f1ado principalmente para aplicaciones web con exposici\u00f3n a internet, usuarios, sesiones, APIs, bases de datos, uploads, etc. \u2014 superficies de ataque que aqu\u00ed simplemente no existen. Lo positivo es que, en los pocos puntos que s\u00ed aplican (principalmente validaci\u00f3n b\u00e1sica de par\u00e1metros booleanos y ausencia de deserializaci\u00f3n o comandos peligrosos), la aplicaci\u00f3n cumple razonablemente bien. No hay riesgo real de inyecci\u00f3n, IDOR, deserializaci\u00f3n insegura, etc., porque no hay entrada no confiable ni parsing de formatos complejos. En conclusi\u00f3n: el bajo porcentaje refleja la naturaleza educativa y minimalista del proyecto, no una falta grave de seguridad. Para una aplicaci\u00f3n real con usuarios y exposici\u00f3n, el porcentaje deber\u00eda ser mucho m\u00e1s alto (idealmente apuntando a Nivel 2). 4. Herramientas autom\u00e1ticas que podr\u00edan ayudar Aunque la aplicaci\u00f3n es muy peque\u00f1a y no tiene dependencias externas ni c\u00f3digo con patrones de alto riesgo, algunas herramientas autom\u00e1ticas que podr\u00edan usarse para verificar requisitos ASVS (especialmente en Input Validation, Malicious Code y malas pr\u00e1cticas generales en Python) son: Bandit : analizador est\u00e1tico de seguridad espec\u00edfico para Python. Detecta autom\u00e1ticamente usos inseguros de pickle , subprocess sin sanitizar, os.system , eval , hashlib d\u00e9bil, etc. Muy \u00fatil para validar contra inyecciones y deserializaci\u00f3n insegura (5.5.x). Semgrep : motor de b\u00fasqueda de patrones con reglas ASVS integradas. Permite buscar c\u00f3digo vulnerable (asignaci\u00f3n masiva, comandos sin escape, etc.) y es muy potente para requisitos como 5.1.x, 5.3.x o 10.x. Safety o pip-audit : chequean vulnerabilidades conocidas en dependencias de PyPI. En este caso no aplicar\u00eda porque no hay requirements.txt ni paquetes externos. No he ejecutado estas herramientas porque el c\u00f3digo es m\u00ednimo, usa solo stdlib y no presenta patrones peligrosos evidentes. Sin embargo, ser\u00edan las m\u00e1s recomendables para proyectos Python m\u00e1s complejos. 5. Valoraci\u00f3n personal del OWASP ASVS OWASP ASVS me parece un est\u00e1ndar muy completo y valioso para proyectos reales, especialmente aplicaciones web empresariales, APIs o sistemas con datos sensibles. Proporciona una lista estructurada, objetiva y actualizada de controles que ayudan a no olvidar aspectos cr\u00edticos (autenticaci\u00f3n, validaci\u00f3n, logging, configuraci\u00f3n segura, etc.). Ventajas : - Es independiente de tecnolog\u00edas \u2192 se puede aplicar a Python, Java, .NET, etc. - Tiene niveles progresivos (L1 b\u00e1sico, L2 est\u00e1ndar, L3 alto) que permiten adaptarlo al riesgo real. - Incluye referencias \u00fatiles (CWE, NIST, Proactive Controls) que facilitan el aprendizaje. - Sirve tanto para desarrollo (como checklist) como para auditor\u00edas/pentesting. Dificultades / limitaciones : - Para aplicaciones muy simples o educativas como esta (scripts locales sin red ni usuarios), se siente como overkill \u2014 la mayor\u00eda de requisitos no aplican y el porcentaje queda rid\u00edculamente bajo. - Requiere tiempo y conocimiento para rellenar correctamente la hoja (sobre todo decidir \"Not Applicable\" vs \"Non-valid\"). - Est\u00e1 muy orientado a aplicaciones web \u2192 para apps de consola, desktop, IoT o embebidas, hay que interpretar muchos puntos con sentido com\u00fan. En definitiva: excelente herramienta para proyectos serios , pero en ejercicios acad\u00e9micos peque\u00f1os sirve m\u00e1s como ejercicio de reflexi\u00f3n que como verificaci\u00f3n real de seguridad. Me ha ayudado a entender mejor qu\u00e9 vulnerabilidades \"no existen\" en mi app precisamente por su dise\u00f1o minimalista.","title":"3. Comprobaci\u00f3n requisitos"},{"location":"ComprobacionRequisitosAplicacion_naiara/#comprobacion-de-requisitos-de-seguridad","text":"","title":"Comprobaci\u00f3n de Requisitos de Seguridad"},{"location":"ComprobacionRequisitosAplicacion_naiara/#1-nivel-de-seguridad-requerido-por-la-aplicacion","text":"La aplicaci\u00f3n consiste en dos scripts Python sencillos ( lavadero.py y main_app.py ) que simulan el funcionamiento de un t\u00fanel de lavado de coches mediante una m\u00e1quina de estados en consola. Caracter\u00edsticas clave que determinan el nivel de seguridad ASVS: Es una aplicaci\u00f3n de consola local , ejecutada directamente en el equipo del desarrollador/estudiante (no hay servidor, no hay interfaz web, no hay API). No existe autenticaci\u00f3n de usuarios, gesti\u00f3n de sesiones ni roles. No recibe entrada de fuentes externas no confiables: los par\u00e1metros (prelavado, secado, encerado) se pasan directamente en el c\u00f3digo o como argumentos fijos en ejemplos de prueba. No hay lectura de stdin interactiva peligrosa, ni par\u00e1metros HTTP, ni ficheros subidos, ni conexiones a red. No maneja ni almacena datos sensibles (PII, financieros, m\u00e9dicos, contrase\u00f1as, claves, etc.). Solo acumula un valor num\u00e9rico de ingresos simulados en memoria. No utiliza dependencias externas (solo librer\u00edas est\u00e1ndar de Python: ninguna instalaci\u00f3n v\u00eda pip). No hay operaciones criptogr\u00e1ficas, logging persistente, uploads/downloads, deserializaci\u00f3n de datos no confiables, llamadas a comandos del sistema ni acceso a recursos del sistema de forma peligrosa. Las \u00fanicas \"entradas\" son booleanos controlados por el programador; no hay riesgo real de inyecci\u00f3n, overflow, path traversal, etc. Por todo ello, el nivel de seguridad m\u00e1s adecuado seg\u00fan OWASP ASVS es el Nivel 1 (L1 \u2013 Opportunistic / Protecci\u00f3n contra vulnerabilidades f\u00e1ciles de descubrir y ataques automatizados b\u00e1sicos). Nivel 2 ya requerir\u00eda controles que no aplican aqu\u00ed (TLS obligatorio, logging de seguridad detallado, protecci\u00f3n contra CSRF, gesti\u00f3n segura de secretos, etc.). Nivel 3 es para aplicaciones cr\u00edticas con requisitos de alta assurance (HSM, re-autenticaci\u00f3n frecuente, auditor\u00eda estricta, etc.). En resumen: ASVS Nivel 1 es suficiente y realista para esta aplicaci\u00f3n sin exposici\u00f3n ni valor real en juego.","title":"1. Nivel de seguridad requerido por la aplicaci\u00f3n"},{"location":"ComprobacionRequisitosAplicacion_naiara/#2-hoja-de-calculo-cumplimentada","text":"He descargado la plantilla OWASP ASVS checklist for audits (versi\u00f3n 4.0.2) y la he renombrado como ASVS-Checklist-Naiara.xlsx . Archivo subido en la tarea: ASVS-Checklist-Naiara.ods He rellenado principalmente las secciones solicitadas en la actividad: Input Validation (hoja 5): varios requisitos marcados como \"Valid\" o \"Non-valid\" con comentarios y referencias al c\u00f3digo. Malicious Code (hoja 10): la mayor\u00eda marcados como \"Not Applicable\" por ser una aplicaci\u00f3n de Nivel 1 y sin carga din\u00e1mica de c\u00f3digo, sin permisos excesivos, sin phone-home, etc. En la pesta\u00f1a ASVS_Results se observa: Cumplimiento total: ~1.09% (3 de 276 criterios cumplidos). \u00danica categor\u00eda con algo de cumplimiento: Input Validation (~11.11%). Todas las dem\u00e1s categor\u00edas a 0% . Esto es completamente esperable dada la simplicidad extrema de la aplicaci\u00f3n. Capturas de pantalla: - Resultados globales y gr\u00e1fico de telara\u00f1a: Secci\u00f3n Input Validation (detalle): Secci\u00f3n Malicious Code (detalle):","title":"2. Hoja de c\u00e1lculo cumplimentada"},{"location":"ComprobacionRequisitosAplicacion_naiara/#3-analisis-del-grado-de-cobertura","text":"El porcentaje global de cumplimiento es extremadamente bajo ( 1.09% ), con solo 3 criterios validados de 276 totales. La \u00fanica categor\u00eda que muestra algo de cumplimiento es Input Validation (11.11%), mientras que el resto de secciones (Arquitectura, Autenticaci\u00f3n, Sesiones, Acceso, Criptograf\u00eda, Logging, etc.) est\u00e1n al 0%. Reflexi\u00f3n: Esta cobertura tan baja no indica que la aplicaci\u00f3n sea insegura , sino que es demasiado simple para que la gran mayor\u00eda de los controles ASVS sean aplicables. ASVS est\u00e1 dise\u00f1ado principalmente para aplicaciones web con exposici\u00f3n a internet, usuarios, sesiones, APIs, bases de datos, uploads, etc. \u2014 superficies de ataque que aqu\u00ed simplemente no existen. Lo positivo es que, en los pocos puntos que s\u00ed aplican (principalmente validaci\u00f3n b\u00e1sica de par\u00e1metros booleanos y ausencia de deserializaci\u00f3n o comandos peligrosos), la aplicaci\u00f3n cumple razonablemente bien. No hay riesgo real de inyecci\u00f3n, IDOR, deserializaci\u00f3n insegura, etc., porque no hay entrada no confiable ni parsing de formatos complejos. En conclusi\u00f3n: el bajo porcentaje refleja la naturaleza educativa y minimalista del proyecto, no una falta grave de seguridad. Para una aplicaci\u00f3n real con usuarios y exposici\u00f3n, el porcentaje deber\u00eda ser mucho m\u00e1s alto (idealmente apuntando a Nivel 2).","title":"3. An\u00e1lisis del grado de cobertura"},{"location":"ComprobacionRequisitosAplicacion_naiara/#4-herramientas-automaticas-que-podrian-ayudar","text":"Aunque la aplicaci\u00f3n es muy peque\u00f1a y no tiene dependencias externas ni c\u00f3digo con patrones de alto riesgo, algunas herramientas autom\u00e1ticas que podr\u00edan usarse para verificar requisitos ASVS (especialmente en Input Validation, Malicious Code y malas pr\u00e1cticas generales en Python) son: Bandit : analizador est\u00e1tico de seguridad espec\u00edfico para Python. Detecta autom\u00e1ticamente usos inseguros de pickle , subprocess sin sanitizar, os.system , eval , hashlib d\u00e9bil, etc. Muy \u00fatil para validar contra inyecciones y deserializaci\u00f3n insegura (5.5.x). Semgrep : motor de b\u00fasqueda de patrones con reglas ASVS integradas. Permite buscar c\u00f3digo vulnerable (asignaci\u00f3n masiva, comandos sin escape, etc.) y es muy potente para requisitos como 5.1.x, 5.3.x o 10.x. Safety o pip-audit : chequean vulnerabilidades conocidas en dependencias de PyPI. En este caso no aplicar\u00eda porque no hay requirements.txt ni paquetes externos. No he ejecutado estas herramientas porque el c\u00f3digo es m\u00ednimo, usa solo stdlib y no presenta patrones peligrosos evidentes. Sin embargo, ser\u00edan las m\u00e1s recomendables para proyectos Python m\u00e1s complejos.","title":"4. Herramientas autom\u00e1ticas que podr\u00edan ayudar"},{"location":"ComprobacionRequisitosAplicacion_naiara/#5-valoracion-personal-del-owasp-asvs","text":"OWASP ASVS me parece un est\u00e1ndar muy completo y valioso para proyectos reales, especialmente aplicaciones web empresariales, APIs o sistemas con datos sensibles. Proporciona una lista estructurada, objetiva y actualizada de controles que ayudan a no olvidar aspectos cr\u00edticos (autenticaci\u00f3n, validaci\u00f3n, logging, configuraci\u00f3n segura, etc.). Ventajas : - Es independiente de tecnolog\u00edas \u2192 se puede aplicar a Python, Java, .NET, etc. - Tiene niveles progresivos (L1 b\u00e1sico, L2 est\u00e1ndar, L3 alto) que permiten adaptarlo al riesgo real. - Incluye referencias \u00fatiles (CWE, NIST, Proactive Controls) que facilitan el aprendizaje. - Sirve tanto para desarrollo (como checklist) como para auditor\u00edas/pentesting. Dificultades / limitaciones : - Para aplicaciones muy simples o educativas como esta (scripts locales sin red ni usuarios), se siente como overkill \u2014 la mayor\u00eda de requisitos no aplican y el porcentaje queda rid\u00edculamente bajo. - Requiere tiempo y conocimiento para rellenar correctamente la hoja (sobre todo decidir \"Not Applicable\" vs \"Non-valid\"). - Est\u00e1 muy orientado a aplicaciones web \u2192 para apps de consola, desktop, IoT o embebidas, hay que interpretar muchos puntos con sentido com\u00fan. En definitiva: excelente herramienta para proyectos serios , pero en ejercicios acad\u00e9micos peque\u00f1os sirve m\u00e1s como ejercicio de reflexi\u00f3n que como verificaci\u00f3n real de seguridad. Me ha ayudado a entender mejor qu\u00e9 vulnerabilidades \"no existen\" en mi app precisamente por su dise\u00f1o minimalista.","title":"5. Valoraci\u00f3n personal del OWASP ASVS"},{"location":"TrazadoVulnerabilidadGoAnywhere/","text":"Trazado de la Vulnerabilidad CVE-2024-0204 en GoAnywhere MFT \u00cdndice Objetivos del Trazado \ud83c\udfaf Punto de Partida: Art\u00edculo de INCIBE \ud83c\uddea\ud83c\uddf8 \u00bfQu\u00e9 es INCIBE? \u2139\ufe0f Productos afectados \u26a0\ufe0f Informaci\u00f3n del Fabricante (Fortra) \ud83c\udfed \u00bfQu\u00e9 es Fortra? Descripci\u00f3n detallada \ud83e\udde9 Impacto real \ud83d\udca5 Soluci\u00f3n recomendada \ud83d\udee1\ufe0f Informaci\u00f3n sobre la Vulnerabilidad (CVE y NVD) \ud83d\udcda P\u00e1gina CVE.org P\u00e1gina NVD (NIST) Criticidad y Vector CVSS \ud83d\udd25 Debilidades Explotadas (CWE) \ud83e\udde0 \u00bfQu\u00e9 es CWE? CWE-425 Patrones de Ataque Relacionados (CAPEC) \ud83c\udfaf CAPEC-143 CAPEC-127 Registro CVE en JSON \ud83d\uddc2\ufe0f Conclusiones / Resumen Final \ud83d\udcdd Objetivos del Trazado Conocer las listas y organismos clave de ciberseguridad (CVE, NVD, CWE, CAPEC, CVSS). Realizar el trazado completo de una vulnerabilidad desde el aviso inicial hasta las debilidades y patrones de ataque. Analizar el riesgo, consecuencias y posibles mitigaciones. Esta vulnerabilidad permite a un atacante no autenticado crear un usuario administrador en GoAnywhere MFT, con grave riesgo de compromiso total del sistema. Punto de Partida: Art\u00edculo de INCIBE \u00bfQu\u00e9 es INCIBE? INCIBE (Instituto Nacional de Ciberseguridad) es la agencia espa\u00f1ola encargada de la ciberseguridad, dependiente del Ministerio de Asuntos Econ\u00f3micos y Transformaci\u00f3n Digital. Publica avisos, alertas y recomendaciones para empresas y ciudadanos. El art\u00edculo de INCIBE enlace nos alerta de una vulnerabilidad cr\u00edtica de omisi\u00f3n de autenticaci\u00f3n en GoAnywhere MFT (Fortra). Un atacante puede crear un usuario administrador sin credenciales previas accediendo directamente al portal de administraci\u00f3n. No se menciona el CVE en el aviso, por lo que el siguiente paso l\u00f3gico es consultar la referencia principal: el advisory del fabricante. Productos afectados : versiones 6.0.1 a 7.4.1 (incluidas). Severidad : Cr\u00edtica (nivel 5/5 seg\u00fan clasificaci\u00f3n de INCIBE). Riesgo principal : Posible toma de control completa del servidor MFT, robo masivo de archivos transferidos o implantaci\u00f3n de malware. Informaci\u00f3n del Fabricante (Fortra) \u00bfQu\u00e9 es Fortra? Fortra (anteriormente HelpSystems) es una empresa estadounidense especializada en software de automatizaci\u00f3n, transferencia segura de archivos (MFT) y ciberseguridad. GoAnywhere MFT es su soluci\u00f3n principal para gesti\u00f3n segura de archivos. En el advisory oficial enlace se identifica la vulnerabilidad como CVE-2024-0204 . Descripci\u00f3n detallada : Existe un endpoint de configuraci\u00f3n inicial ( InitialAccountSetup.xhtml ) que no requiere autenticaci\u00f3n despu\u00e9s de la instalaci\u00f3n. Un atacante puede enviarle una petici\u00f3n POST con datos de un nuevo usuario administrador y tomar el control del sistema sin credenciales previas. Debilidad principal : CWE-425 (Direct Request / Forced Browsing). CVSS : 9.8 Cr\u00edtico \u2192 vector CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H. Impacto real : - Creaci\u00f3n de cuentas privilegiadas \u2192 acceso total a transferencias de archivos, credenciales almacenadas y configuraci\u00f3n. - Posible uso en campa\u00f1as de ransomware (GoAnywhere ya fue explotado masivamente por Cl0p en 2023). - Robo de datos sensibles de empresas que usan MFT para intercambio con proveedores. Soluci\u00f3n recomendada : - Actualizar inmediatamente a 7.4.1 o superior. - En instalaciones existentes sin actualizar: eliminar o renombrar el archivo InitialAccountSetup.xhtml . Informaci\u00f3n sobre la Vulnerabilidad (CVE y NVD) P\u00e1gina CVE.org \u00bfQu\u00e9 es CVE.org? CVE (Common Vulnerabilities and Exposures) es un cat\u00e1logo p\u00fablico mantenido por MITRE que asigna identificadores \u00fanicos (CVE-XXXX-XXXXX) a vulnerabilidades conocidas. Sirve como est\u00e1ndar global para referenciar fallos de seguridad. En https://www.cve.org/CVERecord?id=CVE-2024-0204 encontramos el registro oficial: descripci\u00f3n b\u00e1sica, estado (Published) y enlaces a fuentes primarias (Fortra, NVD). Desde aqu\u00ed se puede descargar el CVE Record en JSON. P\u00e1gina NVD (NIST) \u00bfQu\u00e9 es NVD? NVD (National Vulnerability Database) es la base de datos oficial del NIST (EE.UU.) que enriquece los CVE con an\u00e1lisis detallado: puntuaci\u00f3n CVSS, CWE asociada, referencias y m\u00e9tricas de impacto. En https://nvd.nist.gov/vuln/detail/CVE-2024-0204 se confirma: - CVSS 9.8 Cr\u00edtico - CWE-425 - Vector completo y descripci\u00f3n ampliada - Esto indica que la aplicaci\u00f3n expone funcionalidades cr\u00edticas sin control de acceso adecuado. Criticidad y Vector CVSS Puntuaci\u00f3n CVSS : 9.8 / 10 (Cr\u00edtico) Vector CVSS:3.1 : CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H Desglose de m\u00e9tricas : M\u00e9trica Valor Significado Attack Vector (AV) Network Explotable remotamente por internet sin necesidad de acceso local. Attack Complexity (AC) Low No requiere condiciones especiales ni race conditions. Privileges Required (PR) None No necesita credenciales previas. User Interaction (UI) None No requiere que la v\u00edctima haga clic o interact\u00fae. Scope (S) Unchanged El impacto no sale del componente vulnerable. Confidentiality (C) High Posible exposici\u00f3n total de datos transferidos y almacenados. Integrity (I) High Posible modificaci\u00f3n de archivos, configuraci\u00f3n o inserci\u00f3n de backdoors. Availability (A) High Posible interrupci\u00f3n del servicio MFT (DoS o eliminaci\u00f3n de datos). Esta combinaci\u00f3n hace que la vulnerabilidad sea extremadamente peligrosa en entornos expuestos a internet. Debilidades Explotadas (CWE) \u00bfQu\u00e9 es CWE? CWE (Common Weakness Enumeration) es un cat\u00e1logo mantenido por MITRE que clasifica tipos de debilidades de software (fallos de dise\u00f1o o implementaci\u00f3n) que pueden dar lugar a vulnerabilidades. CWE-425 enlace : Direct Request o Forced Browsing . La aplicaci\u00f3n permite acceder directamente a URLs internas o de configuraci\u00f3n que deber\u00edan estar protegidas por autenticaci\u00f3n o sesi\u00f3n activa. Consecuencias t\u00edpicas : - Acceso no autorizado a paneles administrativos - Creaci\u00f3n/eliminaci\u00f3n de usuarios - Exposici\u00f3n o modificaci\u00f3n de datos sensibles - Escalada a control total del sistema Mitigaciones recomendadas : - Arquitectura y dise\u00f1o : Requerir autenticaci\u00f3n en todas las rutas administrativas desde el primer acceso. - Implementaci\u00f3n : Eliminar o deshabilitar endpoints de setup una vez completada la instalaci\u00f3n inicial. - Buenas pr\u00e1cticas : Usar frameworks con controles de autorizaci\u00f3n integrados (Spring Security, Django auth, etc.). Relaciones : Hijo de CWE-862 (Missing Authorization). CAPECs relacionados : CAPEC-127, CAPEC-143, CAPEC-144, entre otros. Patrones de Ataque Relacionados (CAPEC) \u00bfQu\u00e9 es CAPEC? CAPEC (Common Attack Pattern Enumeration and Classification) es otro cat\u00e1logo de MITRE que describe patrones comunes de ataque que explotan debilidades como las CWE. CAPEC-143 enlace : Detect Unpublicized Web Pages Consiste en adivinar o enumerar URLs no enlazadas p\u00fablicamente (como p\u00e1ginas de setup o admin ocultas). Requisitos : Acceso a la aplicaci\u00f3n expuesta (muy bajo). Consecuencias : Bypass de autenticaci\u00f3n, acceso a funcionalidades cr\u00edticas. Mitigaci\u00f3n : No exponer endpoints innecesarios, usar autenticaci\u00f3n en profundidad. CAPEC-127 enlace : Directory Indexing Similar, pero enfocado en listar contenidos de directorios mal configurados. Habilidades : Muy bajas (herramientas autom\u00e1ticas o fuzzing simple). Mitigaci\u00f3n : Deshabilitar directory listing en el servidor web. Registro CVE en JSON \u00bfQu\u00e9 es el CVE Record en JSON? Es la representaci\u00f3n estructurada (formato JSON) del registro CVE, mantenida por MITRE/CNA. Se usa para alimentaci\u00f3n autom\u00e1tica de herramientas de seguridad (scanners, SIEM, bases de datos internas). Enlace: https://cveawg.mitre.org/api/cve/CVE-2024-0204 Enlace: CVE-2024-0204.json Contiene: - Metadatos (fecha de publicaci\u00f3n, estado) - Descripci\u00f3n oficial - Referencias - Weaknesses (CWE-425) - Posible CPE (plataformas afectadas) Conclusiones / Resumen Final CVE-2024-0204 es una vulnerabilidad cr\u00edtica (CVSS 9.8) de omisi\u00f3n de autenticaci\u00f3n que permite takeover administrativo remoto sin credenciales. Cadena de trazado : INCIBE \u2192 Fortra \u2192 CVE.org \u2192 NVD \u2192 CWE-425 \u2192 CAPEC-143/127 \u2192 JSON estructurado. Riesgo real : Muy alto en entornos expuestos (historial de explotaci\u00f3n masiva en GoAnywhere por Cl0p). Lecci\u00f3n principal : Los endpoints de configuraci\u00f3n inicial deben desactivarse inmediatamente tras la instalaci\u00f3n. Recomendaciones pr\u00e1cticas : Aplicar parche o workaround lo antes posible. Monitorear accesos al puerto 8000/8443 (puertos por defecto de GoAnywhere). Implementar WAF con reglas anti-forced browsing. Revisar si se expone innecesariamente a internet. Este trazado ilustra perfectamente c\u00f3mo las diferentes listas y bases de datos est\u00e1n interconectadas para un an\u00e1lisis completo de cualquier vulnerabilidad.","title":"1. Trazado de vulnerabilidad"},{"location":"TrazadoVulnerabilidadGoAnywhere/#trazado-de-la-vulnerabilidad-cve-2024-0204-en-goanywhere-mft","text":"","title":"Trazado de la Vulnerabilidad CVE-2024-0204 en GoAnywhere MFT"},{"location":"TrazadoVulnerabilidadGoAnywhere/#indice","text":"Objetivos del Trazado \ud83c\udfaf Punto de Partida: Art\u00edculo de INCIBE \ud83c\uddea\ud83c\uddf8 \u00bfQu\u00e9 es INCIBE? \u2139\ufe0f Productos afectados \u26a0\ufe0f Informaci\u00f3n del Fabricante (Fortra) \ud83c\udfed \u00bfQu\u00e9 es Fortra? Descripci\u00f3n detallada \ud83e\udde9 Impacto real \ud83d\udca5 Soluci\u00f3n recomendada \ud83d\udee1\ufe0f Informaci\u00f3n sobre la Vulnerabilidad (CVE y NVD) \ud83d\udcda P\u00e1gina CVE.org P\u00e1gina NVD (NIST) Criticidad y Vector CVSS \ud83d\udd25 Debilidades Explotadas (CWE) \ud83e\udde0 \u00bfQu\u00e9 es CWE? CWE-425 Patrones de Ataque Relacionados (CAPEC) \ud83c\udfaf CAPEC-143 CAPEC-127 Registro CVE en JSON \ud83d\uddc2\ufe0f Conclusiones / Resumen Final \ud83d\udcdd","title":"\u00cdndice"},{"location":"TrazadoVulnerabilidadGoAnywhere/#objetivos-del-trazado","text":"Conocer las listas y organismos clave de ciberseguridad (CVE, NVD, CWE, CAPEC, CVSS). Realizar el trazado completo de una vulnerabilidad desde el aviso inicial hasta las debilidades y patrones de ataque. Analizar el riesgo, consecuencias y posibles mitigaciones. Esta vulnerabilidad permite a un atacante no autenticado crear un usuario administrador en GoAnywhere MFT, con grave riesgo de compromiso total del sistema.","title":"Objetivos del Trazado"},{"location":"TrazadoVulnerabilidadGoAnywhere/#punto-de-partida-articulo-de-incibe","text":"\u00bfQu\u00e9 es INCIBE? INCIBE (Instituto Nacional de Ciberseguridad) es la agencia espa\u00f1ola encargada de la ciberseguridad, dependiente del Ministerio de Asuntos Econ\u00f3micos y Transformaci\u00f3n Digital. Publica avisos, alertas y recomendaciones para empresas y ciudadanos. El art\u00edculo de INCIBE enlace nos alerta de una vulnerabilidad cr\u00edtica de omisi\u00f3n de autenticaci\u00f3n en GoAnywhere MFT (Fortra). Un atacante puede crear un usuario administrador sin credenciales previas accediendo directamente al portal de administraci\u00f3n. No se menciona el CVE en el aviso, por lo que el siguiente paso l\u00f3gico es consultar la referencia principal: el advisory del fabricante. Productos afectados : versiones 6.0.1 a 7.4.1 (incluidas). Severidad : Cr\u00edtica (nivel 5/5 seg\u00fan clasificaci\u00f3n de INCIBE). Riesgo principal : Posible toma de control completa del servidor MFT, robo masivo de archivos transferidos o implantaci\u00f3n de malware.","title":"Punto de Partida: Art\u00edculo de INCIBE"},{"location":"TrazadoVulnerabilidadGoAnywhere/#informacion-del-fabricante-fortra","text":"\u00bfQu\u00e9 es Fortra? Fortra (anteriormente HelpSystems) es una empresa estadounidense especializada en software de automatizaci\u00f3n, transferencia segura de archivos (MFT) y ciberseguridad. GoAnywhere MFT es su soluci\u00f3n principal para gesti\u00f3n segura de archivos. En el advisory oficial enlace se identifica la vulnerabilidad como CVE-2024-0204 . Descripci\u00f3n detallada : Existe un endpoint de configuraci\u00f3n inicial ( InitialAccountSetup.xhtml ) que no requiere autenticaci\u00f3n despu\u00e9s de la instalaci\u00f3n. Un atacante puede enviarle una petici\u00f3n POST con datos de un nuevo usuario administrador y tomar el control del sistema sin credenciales previas. Debilidad principal : CWE-425 (Direct Request / Forced Browsing). CVSS : 9.8 Cr\u00edtico \u2192 vector CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H. Impacto real : - Creaci\u00f3n de cuentas privilegiadas \u2192 acceso total a transferencias de archivos, credenciales almacenadas y configuraci\u00f3n. - Posible uso en campa\u00f1as de ransomware (GoAnywhere ya fue explotado masivamente por Cl0p en 2023). - Robo de datos sensibles de empresas que usan MFT para intercambio con proveedores. Soluci\u00f3n recomendada : - Actualizar inmediatamente a 7.4.1 o superior. - En instalaciones existentes sin actualizar: eliminar o renombrar el archivo InitialAccountSetup.xhtml .","title":"Informaci\u00f3n del Fabricante (Fortra)"},{"location":"TrazadoVulnerabilidadGoAnywhere/#informacion-sobre-la-vulnerabilidad-cve-y-nvd","text":"","title":"Informaci\u00f3n sobre la Vulnerabilidad (CVE y NVD)"},{"location":"TrazadoVulnerabilidadGoAnywhere/#pagina-cveorg","text":"\u00bfQu\u00e9 es CVE.org? CVE (Common Vulnerabilities and Exposures) es un cat\u00e1logo p\u00fablico mantenido por MITRE que asigna identificadores \u00fanicos (CVE-XXXX-XXXXX) a vulnerabilidades conocidas. Sirve como est\u00e1ndar global para referenciar fallos de seguridad. En https://www.cve.org/CVERecord?id=CVE-2024-0204 encontramos el registro oficial: descripci\u00f3n b\u00e1sica, estado (Published) y enlaces a fuentes primarias (Fortra, NVD). Desde aqu\u00ed se puede descargar el CVE Record en JSON.","title":"P\u00e1gina CVE.org"},{"location":"TrazadoVulnerabilidadGoAnywhere/#pagina-nvd-nist","text":"\u00bfQu\u00e9 es NVD? NVD (National Vulnerability Database) es la base de datos oficial del NIST (EE.UU.) que enriquece los CVE con an\u00e1lisis detallado: puntuaci\u00f3n CVSS, CWE asociada, referencias y m\u00e9tricas de impacto. En https://nvd.nist.gov/vuln/detail/CVE-2024-0204 se confirma: - CVSS 9.8 Cr\u00edtico - CWE-425 - Vector completo y descripci\u00f3n ampliada - Esto indica que la aplicaci\u00f3n expone funcionalidades cr\u00edticas sin control de acceso adecuado.","title":"P\u00e1gina NVD (NIST)"},{"location":"TrazadoVulnerabilidadGoAnywhere/#criticidad-y-vector-cvss","text":"Puntuaci\u00f3n CVSS : 9.8 / 10 (Cr\u00edtico) Vector CVSS:3.1 : CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H Desglose de m\u00e9tricas : M\u00e9trica Valor Significado Attack Vector (AV) Network Explotable remotamente por internet sin necesidad de acceso local. Attack Complexity (AC) Low No requiere condiciones especiales ni race conditions. Privileges Required (PR) None No necesita credenciales previas. User Interaction (UI) None No requiere que la v\u00edctima haga clic o interact\u00fae. Scope (S) Unchanged El impacto no sale del componente vulnerable. Confidentiality (C) High Posible exposici\u00f3n total de datos transferidos y almacenados. Integrity (I) High Posible modificaci\u00f3n de archivos, configuraci\u00f3n o inserci\u00f3n de backdoors. Availability (A) High Posible interrupci\u00f3n del servicio MFT (DoS o eliminaci\u00f3n de datos). Esta combinaci\u00f3n hace que la vulnerabilidad sea extremadamente peligrosa en entornos expuestos a internet.","title":"Criticidad y Vector CVSS"},{"location":"TrazadoVulnerabilidadGoAnywhere/#debilidades-explotadas-cwe","text":"\u00bfQu\u00e9 es CWE? CWE (Common Weakness Enumeration) es un cat\u00e1logo mantenido por MITRE que clasifica tipos de debilidades de software (fallos de dise\u00f1o o implementaci\u00f3n) que pueden dar lugar a vulnerabilidades. CWE-425 enlace : Direct Request o Forced Browsing . La aplicaci\u00f3n permite acceder directamente a URLs internas o de configuraci\u00f3n que deber\u00edan estar protegidas por autenticaci\u00f3n o sesi\u00f3n activa. Consecuencias t\u00edpicas : - Acceso no autorizado a paneles administrativos - Creaci\u00f3n/eliminaci\u00f3n de usuarios - Exposici\u00f3n o modificaci\u00f3n de datos sensibles - Escalada a control total del sistema Mitigaciones recomendadas : - Arquitectura y dise\u00f1o : Requerir autenticaci\u00f3n en todas las rutas administrativas desde el primer acceso. - Implementaci\u00f3n : Eliminar o deshabilitar endpoints de setup una vez completada la instalaci\u00f3n inicial. - Buenas pr\u00e1cticas : Usar frameworks con controles de autorizaci\u00f3n integrados (Spring Security, Django auth, etc.). Relaciones : Hijo de CWE-862 (Missing Authorization). CAPECs relacionados : CAPEC-127, CAPEC-143, CAPEC-144, entre otros.","title":"Debilidades Explotadas (CWE)"},{"location":"TrazadoVulnerabilidadGoAnywhere/#patrones-de-ataque-relacionados-capec","text":"\u00bfQu\u00e9 es CAPEC? CAPEC (Common Attack Pattern Enumeration and Classification) es otro cat\u00e1logo de MITRE que describe patrones comunes de ataque que explotan debilidades como las CWE. CAPEC-143 enlace : Detect Unpublicized Web Pages Consiste en adivinar o enumerar URLs no enlazadas p\u00fablicamente (como p\u00e1ginas de setup o admin ocultas). Requisitos : Acceso a la aplicaci\u00f3n expuesta (muy bajo). Consecuencias : Bypass de autenticaci\u00f3n, acceso a funcionalidades cr\u00edticas. Mitigaci\u00f3n : No exponer endpoints innecesarios, usar autenticaci\u00f3n en profundidad. CAPEC-127 enlace : Directory Indexing Similar, pero enfocado en listar contenidos de directorios mal configurados. Habilidades : Muy bajas (herramientas autom\u00e1ticas o fuzzing simple). Mitigaci\u00f3n : Deshabilitar directory listing en el servidor web.","title":"Patrones de Ataque Relacionados (CAPEC)"},{"location":"TrazadoVulnerabilidadGoAnywhere/#registro-cve-en-json","text":"\u00bfQu\u00e9 es el CVE Record en JSON? Es la representaci\u00f3n estructurada (formato JSON) del registro CVE, mantenida por MITRE/CNA. Se usa para alimentaci\u00f3n autom\u00e1tica de herramientas de seguridad (scanners, SIEM, bases de datos internas). Enlace: https://cveawg.mitre.org/api/cve/CVE-2024-0204 Enlace: CVE-2024-0204.json Contiene: - Metadatos (fecha de publicaci\u00f3n, estado) - Descripci\u00f3n oficial - Referencias - Weaknesses (CWE-425) - Posible CPE (plataformas afectadas)","title":"Registro CVE en JSON"},{"location":"TrazadoVulnerabilidadGoAnywhere/#conclusiones-resumen-final","text":"CVE-2024-0204 es una vulnerabilidad cr\u00edtica (CVSS 9.8) de omisi\u00f3n de autenticaci\u00f3n que permite takeover administrativo remoto sin credenciales. Cadena de trazado : INCIBE \u2192 Fortra \u2192 CVE.org \u2192 NVD \u2192 CWE-425 \u2192 CAPEC-143/127 \u2192 JSON estructurado. Riesgo real : Muy alto en entornos expuestos (historial de explotaci\u00f3n masiva en GoAnywhere por Cl0p). Lecci\u00f3n principal : Los endpoints de configuraci\u00f3n inicial deben desactivarse inmediatamente tras la instalaci\u00f3n. Recomendaciones pr\u00e1cticas : Aplicar parche o workaround lo antes posible. Monitorear accesos al puerto 8000/8443 (puertos por defecto de GoAnywhere). Implementar WAF con reglas anti-forced browsing. Revisar si se expone innecesariamente a internet. Este trazado ilustra perfectamente c\u00f3mo las diferentes listas y bases de datos est\u00e1n interconectadas para un an\u00e1lisis completo de cualquier vulnerabilidad.","title":"Conclusiones / Resumen Final"},{"location":"analisisVulnerabilidad/","text":"An\u00e1lisis de Vulnerabilidad: SQL Injection (GET/Search) en bWAPP \u00cdndice 1. Elecci\u00f3n del reto \ud83d\udd0d 2. Demostraci\u00f3n paso a paso \ud83e\uddea 2.1 Funcionamiento normal \u2705 2.2 Comprobaci\u00f3n de vulnerabilidad \u26a0\ufe0f 2.3 Explotaci\u00f3n exitosa \ud83d\udca5 2.4 Observaci\u00f3n de par\u00e1metros y m\u00e9todo HTTP \ud83c\udf10 3. Localizar PHP en el contenedor \ud83d\udc33 3.1 Acceso al contenedor 3.2 Localizaci\u00f3n del archivo vulnerable 4. An\u00e1lisis del c\u00f3digo y niveles de seguridad \ud83d\udd2c 4.1 Control de niveles (security_level_check.php) 4.2 Funci\u00f3n sqli() y niveles 5. Conclusi\u00f3n y mitigaciones \ud83d\udcdd 1. Elecci\u00f3n del reto Voy a analizar una vulnerabilidad en la m\u00e1quina bWAPP, en concreto *** SQL Injection (GET/Search)*** Se muestra una pantalla como esta El c\u00f3digo vulnerable se encuentra en el archivo sqli_1.php , visible en la URL: 2.Demostraci\u00f3n paso a paso 2.1 Funcionamiento normal (uso leg\u00edtimo) Introduzco un t\u00e9rmino de b\u00fasqueda normal, por ejemplo \"iron\" o \"iron man\" , y se muestran solo las pel\u00edculas que coinciden parcialmente con el t\u00edtulo. 2.2 Comprobaci\u00f3n de la vulnerabilidad Introduzco un ap\u00f3strofo simple < asd' > para intentar romper la sintaxis SQL. Aparece un error de MySQL , lo que confirma que el input del usuario se concatena directamente en la consulta sin sanitizaci\u00f3n. 2.3. Explotaci\u00f3n exitosa de la inyecci\u00f3n Utilizo el payload cl\u00e1sico asd' OR 1='1 (o equivalentemente asd' OR '1'='1 ). Resultado: se muestran TODAS las pel\u00edculas de la base de datos, ignorando el filtro de t\u00edtulo. 2.4. Observaci\u00f3n de par\u00e1metros y m\u00e9todo HTTP La petici\u00f3n utiliza m\u00e9todo GET , por lo que el par\u00e1metro vulnerable ( title ) aparece directamente en la URL: 3. Localizar PHP en el contenedor 3.1 Acceso al contenedor bWAPP Identifico el contenedor haciendo uso del comando docker ps Ejecuto los comandos para entrar en el contenedor y cambiarme al directorio /var/www/HTML Docker exec -it bwapp /bin/bash cd /var/www/html 3.2 Localizaci\u00f3n del archivovulnerable Luego localizo el fichero sqli_1.php, por ejemplo con el comando ls sqli* Para ver el c\u00f3digo de este fichero ejecuto cat sqli_1.php 4. An\u00e1lisis del c\u00f3digo vulnerable y gesti\u00f3n de niveles de seguridad El reto SQL Injection (GET/Search) est\u00e1 implementado en el archivo sqli_1.php . 4.1. C\u00f3mo bWAPP controla los niveles de seguridad (security_level_check.php) Antes de que cualquier reto se ejecute, bWAPP incluye el archivo security_level_check.php . Este script comprueba dos cosas principales: Si la cookie security_level est\u00e1 definida. Si la IP del usuario est\u00e1 autorizada (en entornos de prueba suele ser localhost o un rango local). Si alguna de las dos condiciones falla, redirige a security_level_set.php para forzar la configuraci\u00f3n. Captura del contenido de security_level_check.php En esta captura se observa: - Include de admin/settings.php (donde probablemente est\u00e1n definidas constantes como AIM_IPS o AIM_subnet). - C\u00e1lculo de rangos de IPs permitidas usando ip2long, explode y bucles. - Condici\u00f3n final con if(!isset($_COOKIE[\"security_level\"]) || !in_array(...)) que hace el redirect si algo no cuadra. Esto explica por qu\u00e9, al entrar en bWAPP desde localhost con la cookie seteada en \"low\", todo funciona sin redirecciones. 4.2. C\u00f3mo se aplica el nivel de seguridad al input del usuario (funci\u00f3n sqli() en sqli_1.php) Una vez que el nivel est\u00e1 validado, el archivo sqli_1.php define la funci\u00f3n sqli($data) que decide qu\u00e9 hacer con el input del usuario (en este caso, el par\u00e1metro title ). Captura de la funci\u00f3n sqli($data) en sqli_1.php C\u00f3digo: function sqli($data) { switch($_COOKIE[\"security_level\"]) { case \"0\": // Low $data = no_check($data); break; case \"1\": // Medium $data = sqli_check_1($data); break; case \"2\": // High $data = sqli_check_2($data); break; default: // Impossible u otros $data = no_check($data); break; } return $data; } Explicaci\u00f3n por nivel (en el que trabajamos: Low) Low (case \"0\"): Llama a no_check($data) \u2192 no hace absolutamente nada. El input (title) llega limpio y sin filtrar a la consulta SQL \u2192 vulnerable a payloads como ' OR 1='1. Medium (case \"1\"): Usa sqli_check_1($data) \u2192 aplica filtros b\u00e1sicos (elimina ap\u00f3strofos, palabras como OR, etc.). Algunos payloads simples fallan. High (case \"2\"): Usa sqli_check_2($data) \u2192 filtros m\u00e1s estrictos. Mucho m\u00e1s dif\u00edcil explotar. Impossible: Aunque el switch usa no_check por defecto, en nivel Impossible el propio reto cambia la l\u00f3gica (usa consultas preparadas en lugar de concatenaci\u00f3n), por lo que la inyecci\u00f3n ya no funciona. 5 Conclusi\u00f3n Y Recomendaciones Gracias a este dise\u00f1o, bWAPP permite practicar la misma vulnerabilidad (SQL Injection) en diferentes escenarios: desde un entorno totalmente inseguro (Low), pasando por filtros intermedios (Medium y High), hasta un contexto en el que la vulnerabilidad deber\u00eda estar corregida (Impossible). Esto ayuda a entender c\u00f3mo influyen las medidas de validaci\u00f3n y sanitizaci\u00f3n del input en la explotaci\u00f3n real de la aplicaci\u00f3n.","title":"2. An\u00e1lisis de vulnerabilidad"},{"location":"analisisVulnerabilidad/#analisis-de-vulnerabilidad-sql-injection-getsearch-en-bwapp","text":"","title":"An\u00e1lisis de Vulnerabilidad: SQL Injection (GET/Search) en bWAPP"},{"location":"analisisVulnerabilidad/#indice","text":"1. Elecci\u00f3n del reto \ud83d\udd0d 2. Demostraci\u00f3n paso a paso \ud83e\uddea 2.1 Funcionamiento normal \u2705 2.2 Comprobaci\u00f3n de vulnerabilidad \u26a0\ufe0f 2.3 Explotaci\u00f3n exitosa \ud83d\udca5 2.4 Observaci\u00f3n de par\u00e1metros y m\u00e9todo HTTP \ud83c\udf10 3. Localizar PHP en el contenedor \ud83d\udc33 3.1 Acceso al contenedor 3.2 Localizaci\u00f3n del archivo vulnerable 4. An\u00e1lisis del c\u00f3digo y niveles de seguridad \ud83d\udd2c 4.1 Control de niveles (security_level_check.php) 4.2 Funci\u00f3n sqli() y niveles 5. Conclusi\u00f3n y mitigaciones \ud83d\udcdd","title":"\u00cdndice"},{"location":"analisisVulnerabilidad/#1-eleccion-del-reto","text":"Voy a analizar una vulnerabilidad en la m\u00e1quina bWAPP, en concreto *** SQL Injection (GET/Search)*** Se muestra una pantalla como esta El c\u00f3digo vulnerable se encuentra en el archivo sqli_1.php , visible en la URL:","title":"1. Elecci\u00f3n del reto"},{"location":"analisisVulnerabilidad/#2demostracion-paso-a-paso","text":"","title":"2.Demostraci\u00f3n paso a paso"},{"location":"analisisVulnerabilidad/#21-funcionamiento-normal-uso-legitimo","text":"Introduzco un t\u00e9rmino de b\u00fasqueda normal, por ejemplo \"iron\" o \"iron man\" , y se muestran solo las pel\u00edculas que coinciden parcialmente con el t\u00edtulo.","title":"2.1 Funcionamiento normal (uso leg\u00edtimo)"},{"location":"analisisVulnerabilidad/#22-comprobacion-de-la-vulnerabilidad","text":"Introduzco un ap\u00f3strofo simple < asd' > para intentar romper la sintaxis SQL. Aparece un error de MySQL , lo que confirma que el input del usuario se concatena directamente en la consulta sin sanitizaci\u00f3n.","title":"2.2 Comprobaci\u00f3n de la vulnerabilidad"},{"location":"analisisVulnerabilidad/#23-explotacion-exitosa-de-la-inyeccion","text":"Utilizo el payload cl\u00e1sico asd' OR 1='1 (o equivalentemente asd' OR '1'='1 ). Resultado: se muestran TODAS las pel\u00edculas de la base de datos, ignorando el filtro de t\u00edtulo.","title":"2.3. Explotaci\u00f3n exitosa de la inyecci\u00f3n"},{"location":"analisisVulnerabilidad/#24-observacion-de-parametros-y-metodo-http","text":"La petici\u00f3n utiliza m\u00e9todo GET , por lo que el par\u00e1metro vulnerable ( title ) aparece directamente en la URL:","title":"2.4. Observaci\u00f3n de par\u00e1metros y m\u00e9todo HTTP"},{"location":"analisisVulnerabilidad/#3-localizar-php-en-el-contenedor","text":"","title":"3. Localizar PHP en el contenedor"},{"location":"analisisVulnerabilidad/#31-acceso-al-contenedor-bwapp","text":"Identifico el contenedor haciendo uso del comando docker ps Ejecuto los comandos para entrar en el contenedor y cambiarme al directorio /var/www/HTML Docker exec -it bwapp /bin/bash cd /var/www/html","title":"3.1 Acceso al contenedor bWAPP"},{"location":"analisisVulnerabilidad/#32-localizacion-del-archivovulnerable","text":"Luego localizo el fichero sqli_1.php, por ejemplo con el comando ls sqli* Para ver el c\u00f3digo de este fichero ejecuto cat sqli_1.php","title":"3.2 Localizaci\u00f3n del archivovulnerable"},{"location":"analisisVulnerabilidad/#_1","text":"","title":""},{"location":"analisisVulnerabilidad/#4-analisis-del-codigo-vulnerable-y-gestion-de-niveles-de-seguridad","text":"El reto SQL Injection (GET/Search) est\u00e1 implementado en el archivo sqli_1.php .","title":"4. An\u00e1lisis del c\u00f3digo vulnerable y gesti\u00f3n de niveles de seguridad"},{"location":"analisisVulnerabilidad/#41-como-bwapp-controla-los-niveles-de-seguridad-security_level_checkphp","text":"Antes de que cualquier reto se ejecute, bWAPP incluye el archivo security_level_check.php . Este script comprueba dos cosas principales: Si la cookie security_level est\u00e1 definida. Si la IP del usuario est\u00e1 autorizada (en entornos de prueba suele ser localhost o un rango local). Si alguna de las dos condiciones falla, redirige a security_level_set.php para forzar la configuraci\u00f3n. Captura del contenido de security_level_check.php En esta captura se observa: - Include de admin/settings.php (donde probablemente est\u00e1n definidas constantes como AIM_IPS o AIM_subnet). - C\u00e1lculo de rangos de IPs permitidas usando ip2long, explode y bucles. - Condici\u00f3n final con if(!isset($_COOKIE[\"security_level\"]) || !in_array(...)) que hace el redirect si algo no cuadra. Esto explica por qu\u00e9, al entrar en bWAPP desde localhost con la cookie seteada en \"low\", todo funciona sin redirecciones.","title":"4.1. C\u00f3mo bWAPP controla los niveles de seguridad (security_level_check.php)"},{"location":"analisisVulnerabilidad/#42-como-se-aplica-el-nivel-de-seguridad-al-input-del-usuario-funcion-sqli-en-sqli_1php","text":"Una vez que el nivel est\u00e1 validado, el archivo sqli_1.php define la funci\u00f3n sqli($data) que decide qu\u00e9 hacer con el input del usuario (en este caso, el par\u00e1metro title ). Captura de la funci\u00f3n sqli($data) en sqli_1.php C\u00f3digo: function sqli($data) { switch($_COOKIE[\"security_level\"]) { case \"0\": // Low $data = no_check($data); break; case \"1\": // Medium $data = sqli_check_1($data); break; case \"2\": // High $data = sqli_check_2($data); break; default: // Impossible u otros $data = no_check($data); break; } return $data; } Explicaci\u00f3n por nivel (en el que trabajamos: Low) Low (case \"0\"): Llama a no_check($data) \u2192 no hace absolutamente nada. El input (title) llega limpio y sin filtrar a la consulta SQL \u2192 vulnerable a payloads como ' OR 1='1. Medium (case \"1\"): Usa sqli_check_1($data) \u2192 aplica filtros b\u00e1sicos (elimina ap\u00f3strofos, palabras como OR, etc.). Algunos payloads simples fallan. High (case \"2\"): Usa sqli_check_2($data) \u2192 filtros m\u00e1s estrictos. Mucho m\u00e1s dif\u00edcil explotar. Impossible: Aunque el switch usa no_check por defecto, en nivel Impossible el propio reto cambia la l\u00f3gica (usa consultas preparadas en lugar de concatenaci\u00f3n), por lo que la inyecci\u00f3n ya no funciona.","title":"4.2. C\u00f3mo se aplica el nivel de seguridad al input del usuario (funci\u00f3n sqli() en sqli_1.php)"},{"location":"analisisVulnerabilidad/#5-conclusion-y-recomendaciones","text":"Gracias a este dise\u00f1o, bWAPP permite practicar la misma vulnerabilidad (SQL Injection) en diferentes escenarios: desde un entorno totalmente inseguro (Low), pasando por filtros intermedios (Medium y High), hasta un contexto en el que la vulnerabilidad deber\u00eda estar corregida (Impossible). Esto ayuda a entender c\u00f3mo influyen las medidas de validaci\u00f3n y sanitizaci\u00f3n del input en la explotaci\u00f3n real de la aplicaci\u00f3n.","title":"5 Conclusi\u00f3n Y Recomendaciones"},{"location":"reflexion/","text":"Reflexi\u00f3n sobre los riesgos de las aplicaciones Durante esta unidad hemos trabajado con aplicaciones que presentan vulnerabilidades reales o intencionadas, como GoAnywhere MFT (en el trazado de vulnerabilidad del Apartado 1) y una aplicaci\u00f3n de laboratorio vulnerable (utilizada en el Apartado 3 para aplicar el est\u00e1ndar OWASP ASVS). Estas pr\u00e1cticas me han permitido entender no solo c\u00f3mo se explotan fallos de seguridad, sino tambi\u00e9n por qu\u00e9 algunos riesgos son tolerables en entornos de pruebas y absolutamente inaceptables en producci\u00f3n. Principales riesgos identificados en la aplicaci\u00f3n analizada En el an\u00e1lisis del Apartado 3, al evaluar los requisitos ASVS (principalmente Nivel 1 y partes del Nivel 2), detectamos fallos cr\u00edticos que se alinean directamente con varias categor\u00edas del OWASP Top 10 (2021): A01:2021 - Broken Access Control : La aplicaci\u00f3n permit\u00eda accesos no autorizados a funciones administrativas simplemente modificando par\u00e1metros en la URL o cookies. A03:2021 - Injection : Falta total de parametrizaci\u00f3n en consultas a base de datos y ejecuci\u00f3n de comandos del sistema, similar a la vulnerabilidad CVE que trazamos en GoAnywhere (donde un atacante pod\u00eda ejecutar c\u00f3digo arbitrario mediante inyecci\u00f3n en par\u00e1metros de archivo). A02:2021 - Cryptographic Failures : Transmisi\u00f3n de datos sensibles (credenciales, tokens de sesi\u00f3n) en HTTP plano, sin TLS, y almacenamiento de contrase\u00f1as sin hash o con algoritmos d\u00e9biles. A07:2021 - Identification and Authentication Failures : Ausencia de MFA, pol\u00edticas de contrase\u00f1as d\u00e9biles, sesiones persistentes sin timeout y cookies sin atributos Secure, HttpOnly ni SameSite=Strict. A05:2021 - Security Misconfiguration : Exposici\u00f3n de informaci\u00f3n del servidor en cabeceras y p\u00e1ginas de error, directorios listables y configuraciones por defecto inseguras. Estos fallos convierten la aplicaci\u00f3n en un blanco f\u00e1cil: un atacante con conocimientos b\u00e1sicos podr\u00eda escalar privilegios, robar datos de usuarios o ejecutar c\u00f3digo remoto (RCE). En un entorno de pruebas como DVWA o similar, esto es educativo; en producci\u00f3n, ser\u00eda desastroso. Comparaci\u00f3n con aplicaciones de alto riesgo: \u00bfson los mismos riesgos? Aunque las vulnerabilidades t\u00e9cnicas subyacentes son muy parecidas (casi todas derivan de malas pr\u00e1cticas de desarrollo), el nivel de riesgo real cambia radicalmente seg\u00fan el contexto de la aplicaci\u00f3n: Aplicaciones bancarias / financieras (ej. CaixaBank, BBVA, Revolut): Exigen ASVS Nivel 3 (el m\u00e1ximo) y cumplimiento de PCI-DSS, PSD2 y RGPD. Un fallo de inyecci\u00f3n o broken access control podr\u00eda permitir transferencias fraudulentas masivas , blanqueo de capitales o robo de identidad a escala. Impacto: p\u00e9rdidas econ\u00f3micas directas (millones de euros), multas regulatorias enormes (hasta 4% de facturaci\u00f3n global por RGPD) y p\u00e9rdida irreversible de confianza de los clientes. Controles adicionales: monitoreo en tiempo real de transacciones, behavioral biometrics, WAF con ML, auditor\u00edas externas obligatorias cada pocos meses. Aplicaciones de salud / sanitarias (ej. Mi Salud, historiales cl\u00ednicos en hospitales, apps de telemedicina): Nivel ASVS 3 + normativas como RGPD + LOPDGDD + ISO 27001. Exposici\u00f3n de datos de salud (diagn\u00f3sticos, tratamientos, historial gen\u00e9tico) \u2192 posibles consecuencias graves: chantaje, discriminaci\u00f3n (seguros, empleo), estigma social o incluso da\u00f1os f\u00edsicos si se manipulan datos (ej. alterar prescripciones). Riesgo diferencial: no solo econ\u00f3mico, sino impacto en la salud y privacidad \u00edntima de las personas. Redes sociales y plataformas de gran escala (ej. Instagram, TikTok, X/Twitter): Nivel ASVS 2 en la mayor\u00eda de funcionalidades, Nivel 3 en auth, pagos y datos privados. Vulnerabilidades comunes: account takeover, data scraping masivo, XSS/CSRF, broken auth. Impacto a escala: difusi\u00f3n de desinformaci\u00f3n, campa\u00f1as de acoso coordinado, manipulaci\u00f3n de elecciones, robo de datos de millones de usuarios para phishing o venta en dark web. Riesgos espec\u00edficos: algoritmos que amplifican contenido da\u00f1ino, privacidad de datos comportamentales (perfiles psicol\u00f3gicos inferidos), y exposici\u00f3n a deepfakes o doxxing. Conclusi\u00f3n personal En mi opini\u00f3n, esta tarea ha sido una de las m\u00e1s reveladoras del curso. Ver c\u00f3mo una aplicaci\u00f3n aparentemente \u201csimple\u201d puede tener decenas de fallos graves me ha hecho darme cuenta de que la seguridad no es un a\u00f1adido opcional , sino una responsabilidad \u00e9tica y profesional fundamental. He aprendido que: - El nivel ASVS debe elegirse desde la fase de requisitos, en funci\u00f3n del valor de los activos (datos, dinero, reputaci\u00f3n) y del contexto de uso . - Vulnerabilidades que en un laboratorio parecen \u201cdivertidas\u201d de explotar (como SQL Injection b\u00e1sica), en producci\u00f3n pueden destruir vidas, empresas o incluso influir en sociedades enteras. - Como futura desarrolladora, mi meta es aplicar Security by Design y Shift Left Security : integrar controles de seguridad desde el primer commit, usar ASVS como checklist en cada sprint, y nunca asumir que \u201cya lo arreglaremos despu\u00e9s\u201d. En resumen, los riesgos t\u00e9cnicos pueden ser similares en todas las aplicaciones, pero su magnitud y consecuencias dependen directamente de las caracter\u00edsticas del negocio y de los usuarios. Ignorar esto no es solo un error t\u00e9cnico: es poner en peligro a personas reales.","title":"4. Reflexi\u00f3n"},{"location":"reflexion/#reflexion-sobre-los-riesgos-de-las-aplicaciones","text":"Durante esta unidad hemos trabajado con aplicaciones que presentan vulnerabilidades reales o intencionadas, como GoAnywhere MFT (en el trazado de vulnerabilidad del Apartado 1) y una aplicaci\u00f3n de laboratorio vulnerable (utilizada en el Apartado 3 para aplicar el est\u00e1ndar OWASP ASVS). Estas pr\u00e1cticas me han permitido entender no solo c\u00f3mo se explotan fallos de seguridad, sino tambi\u00e9n por qu\u00e9 algunos riesgos son tolerables en entornos de pruebas y absolutamente inaceptables en producci\u00f3n.","title":"Reflexi\u00f3n sobre los riesgos de las aplicaciones"},{"location":"reflexion/#principales-riesgos-identificados-en-la-aplicacion-analizada","text":"En el an\u00e1lisis del Apartado 3, al evaluar los requisitos ASVS (principalmente Nivel 1 y partes del Nivel 2), detectamos fallos cr\u00edticos que se alinean directamente con varias categor\u00edas del OWASP Top 10 (2021): A01:2021 - Broken Access Control : La aplicaci\u00f3n permit\u00eda accesos no autorizados a funciones administrativas simplemente modificando par\u00e1metros en la URL o cookies. A03:2021 - Injection : Falta total de parametrizaci\u00f3n en consultas a base de datos y ejecuci\u00f3n de comandos del sistema, similar a la vulnerabilidad CVE que trazamos en GoAnywhere (donde un atacante pod\u00eda ejecutar c\u00f3digo arbitrario mediante inyecci\u00f3n en par\u00e1metros de archivo). A02:2021 - Cryptographic Failures : Transmisi\u00f3n de datos sensibles (credenciales, tokens de sesi\u00f3n) en HTTP plano, sin TLS, y almacenamiento de contrase\u00f1as sin hash o con algoritmos d\u00e9biles. A07:2021 - Identification and Authentication Failures : Ausencia de MFA, pol\u00edticas de contrase\u00f1as d\u00e9biles, sesiones persistentes sin timeout y cookies sin atributos Secure, HttpOnly ni SameSite=Strict. A05:2021 - Security Misconfiguration : Exposici\u00f3n de informaci\u00f3n del servidor en cabeceras y p\u00e1ginas de error, directorios listables y configuraciones por defecto inseguras.","title":"Principales riesgos identificados en la aplicaci\u00f3n analizada"},{"location":"reflexion/#estos-fallos-convierten-la-aplicacion-en-un-blanco-facil-un-atacante-con-conocimientos-basicos-podria-escalar-privilegios-robar-datos-de-usuarios-o-ejecutar-codigo-remoto-rce-en-un-entorno-de-pruebas-como-dvwa-o-similar-esto-es-educativo-en-produccion-seria-desastroso","text":"","title":"Estos fallos convierten la aplicaci\u00f3n en un blanco f\u00e1cil: un atacante con conocimientos b\u00e1sicos podr\u00eda escalar privilegios, robar datos de usuarios o ejecutar c\u00f3digo remoto (RCE). En un entorno de pruebas como DVWA o similar, esto es educativo; en producci\u00f3n, ser\u00eda desastroso."},{"location":"reflexion/#comparacion-con-aplicaciones-de-alto-riesgo-son-los-mismos-riesgos","text":"Aunque las vulnerabilidades t\u00e9cnicas subyacentes son muy parecidas (casi todas derivan de malas pr\u00e1cticas de desarrollo), el nivel de riesgo real cambia radicalmente seg\u00fan el contexto de la aplicaci\u00f3n: Aplicaciones bancarias / financieras (ej. CaixaBank, BBVA, Revolut): Exigen ASVS Nivel 3 (el m\u00e1ximo) y cumplimiento de PCI-DSS, PSD2 y RGPD. Un fallo de inyecci\u00f3n o broken access control podr\u00eda permitir transferencias fraudulentas masivas , blanqueo de capitales o robo de identidad a escala. Impacto: p\u00e9rdidas econ\u00f3micas directas (millones de euros), multas regulatorias enormes (hasta 4% de facturaci\u00f3n global por RGPD) y p\u00e9rdida irreversible de confianza de los clientes. Controles adicionales: monitoreo en tiempo real de transacciones, behavioral biometrics, WAF con ML, auditor\u00edas externas obligatorias cada pocos meses. Aplicaciones de salud / sanitarias (ej. Mi Salud, historiales cl\u00ednicos en hospitales, apps de telemedicina): Nivel ASVS 3 + normativas como RGPD + LOPDGDD + ISO 27001. Exposici\u00f3n de datos de salud (diagn\u00f3sticos, tratamientos, historial gen\u00e9tico) \u2192 posibles consecuencias graves: chantaje, discriminaci\u00f3n (seguros, empleo), estigma social o incluso da\u00f1os f\u00edsicos si se manipulan datos (ej. alterar prescripciones). Riesgo diferencial: no solo econ\u00f3mico, sino impacto en la salud y privacidad \u00edntima de las personas. Redes sociales y plataformas de gran escala (ej. Instagram, TikTok, X/Twitter): Nivel ASVS 2 en la mayor\u00eda de funcionalidades, Nivel 3 en auth, pagos y datos privados. Vulnerabilidades comunes: account takeover, data scraping masivo, XSS/CSRF, broken auth. Impacto a escala: difusi\u00f3n de desinformaci\u00f3n, campa\u00f1as de acoso coordinado, manipulaci\u00f3n de elecciones, robo de datos de millones de usuarios para phishing o venta en dark web. Riesgos espec\u00edficos: algoritmos que amplifican contenido da\u00f1ino, privacidad de datos comportamentales (perfiles psicol\u00f3gicos inferidos), y exposici\u00f3n a deepfakes o doxxing.","title":"Comparaci\u00f3n con aplicaciones de alto riesgo: \u00bfson los mismos riesgos?"},{"location":"reflexion/#conclusion-personal","text":"En mi opini\u00f3n, esta tarea ha sido una de las m\u00e1s reveladoras del curso. Ver c\u00f3mo una aplicaci\u00f3n aparentemente \u201csimple\u201d puede tener decenas de fallos graves me ha hecho darme cuenta de que la seguridad no es un a\u00f1adido opcional , sino una responsabilidad \u00e9tica y profesional fundamental. He aprendido que: - El nivel ASVS debe elegirse desde la fase de requisitos, en funci\u00f3n del valor de los activos (datos, dinero, reputaci\u00f3n) y del contexto de uso . - Vulnerabilidades que en un laboratorio parecen \u201cdivertidas\u201d de explotar (como SQL Injection b\u00e1sica), en producci\u00f3n pueden destruir vidas, empresas o incluso influir en sociedades enteras. - Como futura desarrolladora, mi meta es aplicar Security by Design y Shift Left Security : integrar controles de seguridad desde el primer commit, usar ASVS como checklist en cada sprint, y nunca asumir que \u201cya lo arreglaremos despu\u00e9s\u201d. En resumen, los riesgos t\u00e9cnicos pueden ser similares en todas las aplicaciones, pero su magnitud y consecuencias dependen directamente de las caracter\u00edsticas del negocio y de los usuarios. Ignorar esto no es solo un error t\u00e9cnico: es poner en peligro a personas reales.","title":"Conclusi\u00f3n personal"}]}